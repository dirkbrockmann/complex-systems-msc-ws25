import{j as x,s as X,t as T}from"./transform.D34fbgXt.js";import{l as $,u as Y,m as v,p as k,f as D,a as G}from"./map.q80aMCoh.js";import{r as m}from"./index.BVOCwoKb.js";import{s as r}from"./styles_module.b6769e26.Bc6uiALE.js";import{r as H}from"./range.DsrFyqpl.js";import{f as I}from"./forEach.DJv7UHbC.js";import{l as E}from"./last.DXTTfs9a.js";import{a as J,b as K,l as O}from"./line.CHfAYkri.js";import{n as P}from"./normal.ulaXCRiq.js";const t={container:{class:"flex flex-col "},display:{width:600,height:300,class:"p-0  mb-0 w-full h-auto "},controls:{width:600,height:170,class:"d3-widgets p-0  mb-0 w-full h-auto ",grid:{x:12,y:12}},widgets:{slider_size:500,slider_girth:10,slider_knob:12,slider_fontsize:18,sliders:[{id:"sigma",label:"noise strength",range:[0,.25],value:.005,position:{x:1,y:2.5}},{id:"k",label:"force strength",range:[-3,3],value:1,position:{x:1,y:6}}],buttons:[{id:"play_pause",actions:["play","pause"],value:0,position:{x:4,y:9.5}},{id:"reset",actions:["rewind"],value:0,position:{x:8,y:9.5}}]},plot:{margin:{l:40,r:30,t:10,b:30},xr:[0,10],yr:[-2,2],xaxis:{label:"t",label_position:{x:280,y:190},fontsize:"16px"},yaxis:{label:"X(t)",label_position:{x:175,y:20},fontsize:"16px"}}},Q=(n,u)=>{var i=[],o=0,j={};const N=P(0,1),e=.01,B=10,z=t.plot.xr[1];var l=t.plot.xr;const C=t.plot.yr,d=$().domain(l).range([t.plot.margin.l,t.display.width-t.plot.margin.r]),f=$().domain(C).range([t.display.height-t.plot.margin.b,t.plot.margin.t]),h=J(d),q=K(f),_=O().x(s=>d(s.t)).y(s=>f(s.X)),A=Y(t.controls.width,t.controls.height,t.controls.grid.x,t.controls.grid.y),a=X(n),y=X(u),F=()=>{o++;let s=w[1].value(),b=w[0].value();I(i,c=>{let M=E(c.trajectory).t,p=E(c.trajectory).X;c.trajectory.push({t:M+e,X:p+s*e*p-e*p*p*p+Math.sqrt(b*e)*N()}),o>z/e/2&&c.trajectory.shift()}),o>z/e/2&&(l=[l[0]+e,l[1]+e],d.domain(l),a.select("#xaxis").call(h)),a.selectAll("."+r.agent).data(i).attr("d",c=>_(c.trajectory))},R=()=>{o=0,i=v(H(B),(s,b)=>({id:b,trajectory:[{t:0,X:0}]})),l=t.plot.xr,d.domain(l),a.select("#xaxis").call(h),a.selectAll("."+r.agent).remove(),a.selectAll("."+r.agent).data(i).enter().append("path").attr("d",s=>_(s.trajectory)).attr("class",r.agent).classed(r.singular,s=>s.id==0)},g=v(t.widgets.buttons,s=>D().id(s.id).value(s.value).actions(s.actions).position(A.position(s.position.x,s.position.y))),w=v(t.widgets.sliders,s=>G().id(s.id).label(s.label).range(s.range).value(s.value).fontsize(t.widgets.slider_fontsize).size(t.widgets.slider_size).girth(t.widgets.slider_girth).knob(t.widgets.slider_knob).position(A.position(s.position.x,s.position.y)));R();function L(s){g[0].value()==1?j=T(F,0):j.stop()}return g[0].update(L),g[1].update(R),y.selectAll(null).data(g).enter().append(k),y.selectAll(null).data(w).enter().append(k),a.append("g").datum(t.plot.xaxis).attr("class",r.axis).attr("id","xaxis").attr("transform",function(s){return"translate(0,"+f(0)+")"}).call(h).style("font-size",t.plot.xaxis.fontsize),a.append("g").datum(t.plot.yaxis).attr("class",r.axis).attr("transform",function(s){return"translate("+d(0)+",0)"}).call(q).style("font-size",t.plot.xaxis.fontsize),()=>{y.selectAll("*").remove(),a.selectAll("*").remove()}},it=({id:n})=>{const u=m.useRef(null),i=m.useRef(null),o=m.useRef(null);return m.useEffect(()=>Q(i.current,o.current),[n]),x.jsx(x.Fragment,{children:x.jsxs("div",{ref:u,id:n,className:t.container.class,children:[x.jsx("svg",{ref:i,id:`${n}-display`,className:t.display.class,width:t.display.width,height:t.display.height,viewBox:`0 0 ${t.display.width} ${t.display.height}`}),x.jsx("svg",{ref:o,id:`${n}-controls`,className:t.controls.class,width:t.controls.width,height:t.controls.height,viewBox:`0 0 ${t.controls.width} ${t.controls.height}`})]})})};export{it as default};
